# KTO: Model Alignment as Prospect Theoretic Optimization

**논문 발표**: 2024년
**저자**: Kawin Ethayarajh, Winnie Xu, Niklas Muennighoff, Dan Jurafsky, Douwe Kiela
**소속**: Stanford, Contextual AI
**논문 링크**: [arXiv:2402.01306](https://arxiv.org/abs/2402.01306)

---

## 한 줄 요약
> Paired preference 데이터 없이 개별 응답에 대한 Good/Bad 라벨만으로 alignment를 수행하여, 데이터 수집 비용을 크게 줄이면서 DPO와 동등한 성능 달성

---

## 1. 동기

### 1.1 DPO의 데이터 요구사항

```
DPO: (prompt, y_w, y_l) 쌍 필요
     → 같은 프롬프트에 대해 2개 응답 필요

KTO: (prompt, y, label) 만 필요
     → 개별 응답에 good/bad 라벨
```

### 1.2 실제 데이터

대부분의 피드백은 개별적 (thumbs up/down)

---

## 2. Prospect Theory 기반

### 2.1 핵심 아이디어

인간은 **이득보다 손실에 더 민감** (Loss aversion)

### 2.2 KTO Loss

$$\mathcal{L}_{\text{KTO}} = \mathbb{E}_{y \sim \pi_\theta}\left[w(y)(1 - v_{\text{KTO}}(y))\right]$$

- 좋은 응답: 확률 높이기
- 나쁜 응답: 확률 낮추기 (더 강하게)

---

## 3. 장점

1. **데이터 효율**: Unpaired 데이터 사용 가능
2. **수집 용이**: 개별 라벨링이 쌍 비교보다 쉬움
3. **기존 데이터 활용**: Upvote/downvote 데이터 직접 사용

---

## 4. 실험 결과

| 방법 | 데이터 타입 | MT-Bench |
|------|------------|----------|
| DPO | Paired | 기준 |
| **KTO** | **Unpaired** | **동등** |

---

## 5. 핵심 요약

1. **핵심**: Paired → Unpaired 데이터
2. **이론**: Prospect theory (손실 회피)
3. **장점**: 데이터 수집 비용 절감
4. **결과**: DPO와 동등 성능

---

## 참고 자료

1. [KTO 논문](https://arxiv.org/abs/2402.01306)

---

*이전 리뷰: [IPO](./003_IPO.md)*
*다음 리뷰: [ORPO](./005_ORPO.md)*
